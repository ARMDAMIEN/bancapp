<div class="onboarding-container">
    <div class="onboarding-wrapper">
        <!-- Header -->
        <div class="onboarding-header">
            <div class="logo-container">
                <img src="assets/logo.png" alt="Logo" class="logo-image">
            </div>
            <h1 class="onboarding-title">Account Setup</h1>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" [style.width.%]="currentStep * (100/totalSteps)"></div>
            </div>
            <div class="progress-steps">
                <div *ngFor="let step of steps; let i = index" class="progress-step"
                    [ngClass]="{'active': currentStep >= i+1, 'current': currentStep === i+1}">
                    <div class="step-number">{{ i+1 }}</div>
                    <div class="step-label">{{ step }}</div>
                </div>
            </div>
        </div>

        <!-- Content Area -->
        <div class="onboarding-content">
            <!-- Step 1: Wallet Information -->
            <div class="onboarding-step" *ngIf="currentStep === 1">
                <div class="step-header">
                    <h2 class="step-title">Your Wallet Information</h2>
                    <p class="step-description">
                        Please provide your wallet address where you'll receive your profits and withdrawals. All
                        profits will be paid in USDC.
                    </p>
                    <div class="info-banner">
                        <i class="info-icon"></i>
                        <p>Our trading bot uses USDC (USD Coin) for all operations. USDC is a stable cryptocurrency
                            pegged to the US dollar, which means 1 USDC = 1 USD.</p>
                    </div>
                </div>
                <div class="step-content">
                    <!-- Partie à modifier dans Step 1: Wallet Information -->
                    <form class="onboarding-form" [formGroup]="walletForm" (ngSubmit)="saveWallet()">
                        <div class="form-group">
                            <label for="walletNetwork" class="form-label">Wallet Network</label>
                            <div class="select-wrapper">
                                <select id="walletNetwork" class="form-select" formControlName="walletNetwork">
                                    <option value="" disabled selected>Select network</option>
                                    <option value="ERC20">Ethereum (ERC20)</option>
                                    <option value="TRC20">Tron (TRC20)</option>
                                    <option value="SOL">Solana</option>
                                    <option value="MATIC">Polygon</option>
                                </select>
                                <div class="select-arrow"></div>
                            </div>
                            <span class="helper-text" *ngIf="wallet['walletNetwork'].value">
                                Make sure your wallet supports USDC on the {{ wallet['walletNetwork'].value }} network.
                            </span>
                            <div class="validation-message"
                                *ngIf="wallet['walletNetwork'].invalid && wallet['walletNetwork'].touched">
                                Please select a wallet network.
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="walletAddress" class="form-label">Wallet Address</label>
                            <input type="text" id="walletAddress" class="form-input" formControlName="walletAddress"
                                placeholder="Enter your wallet address">

                            <div class="validation-message"
                                *ngIf="wallet['walletAddress'].touched && wallet['walletAddress'].invalid">
                                <div *ngIf="wallet['walletAddress'].errors?.['required']">Wallet address is required.
                                </div>
                                <div *ngIf="wallet['walletAddress'].errors?.['pattern']">Please enter a valid wallet
                                    address.</div>
                            </div>
                        </div>

                        <div class="form-group checkbox-group">
                            <label class="checkbox-container">
                                <input type="checkbox" formControlName="confirmWalletOwnership">
                                <span class="checkmark"></span>
                                <span class="checkbox-label">I confirm that I own this wallet and have access to
                                    it.</span>
                            </label>
                            <div class="validation-message"
                                *ngIf="wallet['confirmWalletOwnership'].touched && wallet['confirmWalletOwnership'].invalid">
                                You must confirm that you own this wallet.
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="form-button primary">Continue</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Step 2: Transfer Funds -->
            <div class="onboarding-step" *ngIf="currentStep === 2">
                <div class="step-header">
                    <h2 class="step-title">Initial USDC Deposit</h2>
                    <p class="step-description">
                        To start trading, please transfer USDC to our bot's wallet address on your preferred network.
                    </p>
                    <div class="info-banner">
                        <i class="info-icon"></i>
                        <p>USDC is available on multiple blockchain networks. Select the network you prefer to use for
                            your deposit.</p>
                    </div>
                </div>

                <div class="step-content">
                    <div class="transfer-info-container">
                        <div class="network-selector">
                            <div *ngFor="let network of botWallets" class="network-option"
                                [ngClass]="{'active': selectedBotWallet === network.id}"
                                (click)="selectBotWallet(network.id)">
                                <div class="network-icon" [style.background-color]="network.color">
                                    <span>{{ network.symbol }}</span>
                                </div>
                                <div class="network-name">{{ network.name }}</div>
                            </div>
                        </div>

                        <div class="wallet-details">
                            <div class="wallet-card">
                                <div class="wallet-card-header">
                                    <h3 class="wallet-title">Bot Wallet Address</h3>
                                    <div class="wallet-network-badge">{{ getBotWallet().network }} <span
                                            class="usdc-badge">USDC</span></div>
                                </div>
                                <div class="wallet-address-container">
                                    <div class="wallet-address">{{ getBotWallet().address }}</div>
                                    <button class="copy-button" (click)="copyWalletAddress()">
                                        <i class="copy-icon"></i>
                                        <span>Copy</span>
                                    </button>
                                </div>
                                <div class="qr-code-container">
                                    <div class="qr-code">
                                        <!-- QR code placeholder - In a real app, generate dynamically -->
                                        <img [src]="'assets/qr-' + selectedBotWallet + '.png'" alt="QR Code"
                                            class="qr-image">
                                    </div>
                                </div>
                                <div class="wallet-instructions">
                                    <div class="instruction-item">
                                        <div class="instruction-number">1</div>
                                        <div class="instruction-text">Make sure to send <strong>USDC</strong> on the
                                            <strong>{{ getBotWallet().network }}</strong> network.
                                        </div>
                                    </div>
                                    <div class="instruction-item">
                                        <div class="instruction-number">2</div>
                                        <div class="instruction-text">Minimum deposit amount: <strong>{{
                                                getBotWallet().minDeposit }}</strong></div>
                                    </div>
                                    <div class="instruction-item">
                                        <div class="instruction-number">3</div>
                                        <div class="instruction-text"><strong>IMPORTANT:</strong> Only send USDC. Any
                                            other currency sent to this address may be lost.</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button class="form-button secondary" (click)="goToPreviousStep()">Back</button>
                        <button class="form-button primary" (click)="goToNextStep()">I've Completed The
                            Transfer</button>
                    </div>
                </div>
            </div>

            <!-- Step 3: Confirmation -->
            <div class="onboarding-step" *ngIf="currentStep === 3">
                <div class="step-header">
                    <h2 class="step-title">Transfer Confirmation</h2>
                    <p class="step-description">
                        Please provide the transaction details to help us verify your deposit.
                    </p>
                </div>

                <div class="step-content">
                    <!-- Partie à modifier dans Step 3: Confirmation -->
                    <form class="onboarding-form" [formGroup]="confirmationForm" (ngSubmit)="saveDeposit()">
                        <div class="form-group">
                            <label for="transactionId" class="form-label">Transaction ID (Optional)</label>
                            <input type="text" id="transactionId" class="form-input" formControlName="transactionId"
                                placeholder="Enter the transaction ID/hash">
                            <span class="helper-text">
                                Providing the transaction ID will help us process your deposit faster.
                            </span>
                        </div>

                        <div class="form-group">
                            <label for="depositAmount" class="form-label">Deposit Amount</label>
                            <div class="input-with-suffix">
                                <input type="number" id="depositAmount" class="form-input"
                                    formControlName="depositAmount" placeholder="Enter the amount you transferred">
                                <span class="input-suffix">{{ getBotWallet().currency }}</span>
                            </div>
                            <div class="validation-message"
                                *ngIf="confirmation['depositAmount'].touched && confirmation['depositAmount'].invalid">
                                <div *ngIf="confirmation['depositAmount'].errors?.['required']">Deposit amount is
                                    required.
                                </div>
                                <div *ngIf="confirmation['depositAmount'].errors?.['min']">Minimum deposit amount is
                                    100.
                                </div>
                            </div>
                        </div>

                        <div class="form-group checkbox-group">
                            <label class="checkbox-container">
                                <input type="checkbox" formControlName="confirmDeposit">
                                <span class="checkmark"></span>
                                <span class="checkbox-label">I confirm that I have completed the transfer.</span>
                            </label>
                            <div class="validation-message"
                                *ngIf="confirmation['confirmDeposit'].touched && confirmation['confirmDeposit'].invalid">
                                You must confirm that you have completed the transfer.
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="form-button secondary"
                                (click)="goToPreviousStep()">Back</button>
                            <button type="submit" class="form-button primary">Confirm Deposit</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Step 4: Completion -->
            <div class="onboarding-step completion-step" *ngIf="currentStep === 4">
                <div class="completion-icon">
                    <i class="check-icon"></i>
                </div>

                <div class="completion-content">
                    <h2 class="completion-title">USDC Deposit In Process</h2>
                    <p class="completion-message">
                        Thank you for your USDC deposit! Your funds are on the way and will be credited to your account
                        within 24-48 hours after the blockchain confirmation.
                    </p>

                    <div class="completion-details">
                        <div class="detail-item">
                            <span class="detail-label">Deposit Amount:</span>
                            <span class="detail-value">{{ userData.depositAmount }} {{ getBotWallet().currency }}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Wallet Network:</span>
                            <span class="detail-value">{{ getBotWallet().network }}</span>
                        </div>
                        <div class="detail-item" *ngIf="userData.transactionId">
                            <span class="detail-label">Transaction ID:</span>
                            <span class="detail-value transaction-id">{{ userData.transactionId }}</span>
                        </div>
                    </div>

                    <div class="next-steps">
                        <h3 class="next-steps-title">What's Next?</h3>
                        <ul class="steps-list">
                            <li class="step-item">
                                <i class="step-icon wallet-icon"></i>
                                <div class="step-text">Your deposit will be verified on the blockchain</div>
                            </li>
                            <li class="step-item">
                                <i class="step-icon notification-icon"></i>
                                <div class="step-text">You'll receive a confirmation email when funds are credited</div>
                            </li>
                            <li class="step-item">
                                <i class="step-icon trading-icon"></i>
                                <div class="step-text">The bot will start trading with your funds</div>
                            </li>
                            <li class="step-item">
                                <i class="step-icon profit-icon"></i>
                                <div class="step-text">You can track your portfolio performance in the dashboard</div>
                            </li>
                        </ul>
                    </div>

                    <div class="completion-actions">
                        <button class="form-button primary" (click)="navigateToDashboard()">Go to Dashboard</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notification for Copy Action -->
        <div class="copy-notification" *ngIf="showCopyNotification">
            Address copied to clipboard!
        </div>
    </div>
</div>